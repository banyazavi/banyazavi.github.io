---
title: "[OMV4 NAS] 디스크 마운트 및 공유 폴더 설정"
excerpt: 일단 공간을 만들어 놔야 뭘 담을 수 있겠죠?
key: post-2019-10-09-01
categories:
  - OMV4 자작 NAS 구축
sidebar:
  - nav: omv4_nas
tags:
  - NAS
  - openmediavault
---

OMV4가 설치되어 실행되게 되면 웹 브라우저에 IP를 입력하여 웹 패널에 접속하도록 합니다. 기본 ID와 비밀번호는 `admin`, `openmediavault`이에요. 웹 패널의 관리자 아이디는 `admin` 고정으로 바꿀 수 없습니다. 비밀번호는 **일반 설정 > 웹 관리자 암호** 페이지에서 바로 바꾸는 것이 안전합니다.

---

# 파일 시스템 생성
## 디스크 확인

**저장소 > 디스크** 페이지에 들어가면 현재 인식된 저장장치의 목록을 볼 수 있습니다.

![저장소 > 디스크 목록]({{"/assets/images/2019-10-09/2019-10-09-01-01.png"| relative_url}})

저는 데이터 저장 공간으로 `/dev/sda`에 연결된 장치를 사용할 거예요.

이제 **저장소 > 파일 시스템** 페이지로 가서 이 디스크를 포맷하고 마운트합니다.

## 파일 시스템 확인

![저장소 > 파일 시스템 목록]({{"/assets/images/2019-10-09/2019-10-09-01-02.png"| relative_url}})

아까 확인한 디스크가 목록에 없는 것을 볼 수 있습니다. **생성** 버튼을 눌러 파일 시스템을 생성합니다.

## 파일 시스템 생성

![파일 시스템 생성]({{"/assets/images/2019-10-09/2019-10-09-01-03.png"| relative_url}})

아까 확인해 둔 디스크를 선택하고 적당한 레이블 이름을 짓습니다. 파일 시스템은 **EXT4**가 기본값으로 설정되어 있어요. 시놀로지의 경우 **BTRFS**를 기본으로 선택하고 있는데, 서로 장단이 있으니 비교하여 선택하도록 합니다.

그리고 확인을 누르면 이제 포맷을 향한 긴 기다림이 있습니다. 때에 따라 굉장히 오래 걸릴 수 있거든요.

![파일 시스템 생성 완료]({{"/assets/images/2019-10-09/2019-10-09-01-04.png"| relative_url}})

이렇게 파일 시스템이 생성되었으면, **마운트** 버튼을 눌러서 등록합니다. **마운트를 하지 않으면 공유 폴더에 등록할 수가 없어요!**

> **[NOTE]**  
> OMV는 시스템 파티션에 데이터를 저장하도록 허용하지 않습니다. 따라서 OMV (데비안) 를 설치하는 파티션과 데이터를 저장하는 파티션을 나누어서 설치해야 해요.
>
> 문제는 OMV 설치 이미지가 파티션 분할을 지원하지 않는다는 점입니다. 따라서, 단일 디스크에 OMV 설치와 데이터 보관을 같이 하려는 경우에는 **Debian 9 (Stretch)** 설치 후 OMV4 설치 스크립트를 실행하여 OMV4를 설치하는 편이 좋습니다.
>
> [데비안 9 설치 후 OMV4 설치 가이드 (스크립트 포함)](https://openmediavault.readthedocs.io/en/latest/installation/on_debian.html){: target="_blank"}

# 공유 폴더 추가

이제 마운트 된 파티션에 대해 공유 폴더를 설정할 차례입니다.

## 홈 디렉토리 생성 (Optional)

이 과정은 OMV에 대해 `root` 계정 외에 `ssh` 접속을 하려고 하거나, 이후 설정하는 **SMB**에서 홈 경로를 활성화하려는 경우 필요합니다. 홈 디렉토리 설정을 한 후 사용자를 추가해야 ssh 접속 시 명령어 자동완성을 사용할 수 있으니 가능한 설정하는 것이 좋아요.

![홈 디렉토리용 공유 폴더 추가]({{"/assets/images/2019-10-09/2019-10-09-01-05.png"| relative_url}})

이후의 과정은 사용자 생성 글에서 이어서 다룰게요. ~~이럴 거면 포스트를 합칠걸...~~

## 공유 폴더 추가

구성하려는 나스의 특성에 따라 공유 폴더를 추가합니다. 저는 이렇게 구성할 거예요.

- (Optional) 사용자 홈 디렉토리
- Contents 폴더. 관리자가 자료를 넣고 사용자는 읽을 수만 있습니다.
- Public 폴더. 모든 사용자가 읽기/쓰기 가능합니다.

첫 번째 폴더를 만들어봅시다.

![Contents 폴더 추가]({{"/assets/images/2019-10-09/2019-10-09-01-06.png"| relative_url}})

위와 같이 설정하여 폴더를 생성합니다. 시놀로지와 다르게 OMV는 공유 폴더의 경로를 드라이브의 루트가 아닌 곳으로도 지정할 수 있어요. 이 점으로 인해 관리자용 메타 공유 폴더를 추가하거나, 사용자별로 개인 공유 폴더를 부여하는 등의 유연한 관리가 가능하지만, **반대급부로 폴더 권한이 꼬이기도 아주 좋습니다.** 헷갈리지 않도록 구성하는 것이 중요하죠.

공유 폴더의 권한은 리눅스의 **Owner-Group-Other** 권한을 의미합니다. 따라서 위 그림의 권한은 **관리자: 읽기/쓰기, 사용자: 읽기/쓰기, 기타: 읽기 전용**, 즉 리눅스에서 말하는 `rwxrwxr-x` 또는 `0775`와 같아요. 그러나 OMV는 **ACL**<sup>Access Control List</sup>이라고 하는 일종의 확장된 권한 관리 시스템을 사용하므로, 기본값을 수정할 이유가 별로 없는 것 같네요.

아무튼, 나머지 폴더도 위와 같이 만들면 이렇게 목록이 만들어집니다.

![최종 공유 폴더 목록]({{"/assets/images/2019-10-09/2019-10-09-01-07.png"| relative_url}})

이제 폴더는 다 추가하였고, 이 폴더를 사용할 사용자들을 만들 차례입니다. 다음 글에서 계속할게요.
