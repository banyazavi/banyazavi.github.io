---
title: "[OMV4 NAS] 그룹 및 사용자 추가, 공유 폴더 권한 부여"
excerpt: 좋은 것은 같이 봐야죠. 그러려면 사용자를 만들어야 합니다. 하지만 나만 보고 싶은 것도 있잖아요? 그래서 그룹도 만들어야 해요.
key: post-2019-10-13-01
categories:
  - OMV4 자작 NAS 구축
sidebar:
  - nav: omv4_nas
tags:
  - NAS
  - openmediavault
---

나스를 혼자 쓸 생각이라면 중요하지 않지만, 다른 사람도 사용하게 하고 싶다면 사용자 관리가 중요합니다. 리눅스는 원래 여러 사람이 사용할 수 있게 설계되었기에 이 부분에 대해서는 잘 준비가 되어있어요.

---

# 사용자 그룹 계획 세우기

권한을 사용자에게도 줄 수 있지만, 그렇게 관리했다가는 사용자가 조금만 늘어도 헷갈리기 시작할 거예요. 그래서 보통은 사용자들을 **그룹**에 소속시키고, 여기에 권한을 부여하여 사용하게 됩니다.

우리도 그렇게 해 봅시다. 저는 이렇게 세 개의 그룹을 만들었어요.

- 관리자 그룹 (Administrators). 모든 폴더에 대한 읽기/쓰기 권한을 가집니다.
- 사용자 그룹 (Members). 모든 폴더에 대한 읽기와, **Public** 폴더라는 곳에서는 쓰기도 가능합니다.
- 제한된 사용자 그룹 (Guests). **Public** 폴더에만 읽기 권한이 있습니다.

이렇게 만들어보도록 할게요.

# 그룹 추가

**접근 권한 관리 > 그룹** 페이지에서 그룹을 추가할 수 있어요.

![관리자 그룹 추가]({{"/assets/images/2019-10-13/2019-10-13-01-01.png"| relative_url}})

이런 식으로 그룹을 추가합니다. 구성원은 나중에 사용자 페이지에서 추가할 생각이니 신경 쓰지 않아도 됩니다. ~~어차피 아직 사용자를 안 만들었~~

나머지 그룹 생성 화면도 스크린샷을 찍기는 했는데요. 스크롤 낭비 같아서 생략합니다. 아무튼, 계획한 그룹을 모두 만들게 되면 아래와 같이 됩니다.

![접근 권한 관리 > 그룹 목록]({{"/assets/images/2019-10-13/2019-10-13-01-02.png"| relative_url}})

그리고 이제 사용자를 추가하러 가는데, 잠깐만요!

# 사용자 추가
## 홈 디렉토리 생성 (Optional)

![접근 권한 관리 > 사용자, 설정 탭]({{"/assets/images/2019-10-13/2019-10-13-01-03.png"| relative_url}})

저번에 하다 만 부분이 있었는데, 홈 디렉토리를 생성하는 부분입니다.

**접근 권한 관리 > 사용자** 페이지의 **설정** 탭에 들어갑니다. 그리고 옵션 활성화를 하고, 홈 디렉토리 목적으로 만든 공유 폴더를 연결해 줍니다.

## 사용자 추가

이제 사용자를 추가합니다. **접근 권한 관리 > 사용자** 페이지에서 추가할 수 있어요.

일단 그룹별로 한 명씩 만들어볼게요.

![banyazavi 사용자 추가]({{"/assets/images/2019-10-13/2019-10-13-01-04.png"| relative_url}})

사실, 이름과 암호를 제외하면 필수로 입력하는 항목은 아닙니다.

이제 그룹도 설정해 볼까요.

![사용자 그룹 할당]({{"/assets/images/2019-10-13/2019-10-13-01-05.png"| relative_url}})

관리자 목적으로 만든 사용자이므로 관리자 그룹을 선택해 줍니다. 이 화면에선 보이지 않지만, 사용자 생성 시 기본값으로 **users** 그룹이 체크되어 있는데요. 이를 그룹 권한 관리하면서 바꿔줄 수 있긴 하지만, OMV는 기본적으로 users 그룹으로 폴더나 파일을 생성하므로 굳이 체크를 해제할 필요는 없습니다.

> **[NOTE]**  
> 이 사용자를 통해 `ssh`를 사용하려고 한다면 **일반** 탭의 **셸** 부분도 신경 써주어야 합니다. 일반적으로 `/bin/bash`로 설정하면 크게 무리가 없어요.

![ssh, sudo 그룹 할당]({{"/assets/images/2019-10-13/2019-10-13-01-06.png"| relative_url}})

그리고 **ssh** 그룹 (`ssh` 접속 허용) 과 **sudo** 그룹 (`sudo` 명령을 통한 `root` 권한 실행 허용) 도 추가시켜 주어야 합니다.

home 디렉토리를 만들지 않았으면 **Tab** 키를 통한 명령어 자동완성이 지원되지 않으니, home 폴더도 만드는 것이 좋습니다.

# 공유 폴더의 접근 권한 관리

저번 포스트에서 만든 공유 폴더들에 정책에 맞는 접근 권한을 줍니다.

**권한**과 **접근 제어 목록** 두 가지가 있는데,

- **권한**: 해당 공유 폴더가 서비스의 최상위 폴더로 노출되는 것에 대한 설정
- **접근 제어 목록**: 실제 파일/폴더에 적용된 접근 권한

이라고 설명할 수 있습니다.

직관적으로 이해가 가지 않을 수 있는데요, 나중에 권한을 주지 않은 채로 접근 제어 목록에 권한을 준 뒤 FTP 등의 서비스로 접속해 보면 무슨 의미인지 알 수 있습니다. 이 글의 구성에서는 양쪽을 다르게 설정할 이유가 없으므로, 두 설정의 내용을 똑같이 맞추어 주면 됩니다.

아무튼, **Contents** 폴더에 권한을 부여합니다. 아래의 폴더는 **관리자 그룹**에게는 읽기/쓰기를, **사용자 그룹**에는 읽기만을, 그리고 **제한된 사용자 그룹 (게스트)**의 접근은 거부하는 구성이네요.

![Contents 공유 폴더 권한 설정]({{"/assets/images/2019-10-13/2019-10-13-01-07.png"| relative_url}})

접근 제어 목록도 같은 정책으로 수정합니다.

![Contents 공유 폴더 접근 제어 목록 설정]({{"/assets/images/2019-10-13/2019-10-13-01-08.png"| relative_url}})

하단의 **재귀적으로 - 파일과 디렉터리에 권한을 적용** 옵션을 켜 주게 되면, 해당 폴더의 하위 파일과 폴더에도 같은 설정이 적용됩니다. ~~어색한 번역~~

자, 이제 폴더와 사용자 구성도 모두 끝났습니다. 이제 서비스를 설정하여 나스에 접속할 준비는 끝났습니다. 다음 글에서 서비스를 하나 설정해 보도록 합시다.
