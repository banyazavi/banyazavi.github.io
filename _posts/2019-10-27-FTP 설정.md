---
title: FTP 설정
key: post-2019-10-27-01
categories:
  - OMV4 자작 NAS 구축하기
sidebar:
  - nav: "omv4_guide"
tags:
  - FTP
  - NAS
  - openmediavault
---

> FTP만 잘 설정되어 있어도 나스를 통한 파일 전송은 대부분 해결됩니다. 괜히 이름이 **File Transfer Protocol**이 아니거든요.

<!--more-->

**FTP**<sup>File Transfer Protocol</sup>는 네트워크에서 가장 유명한 파일 전송 방법입니다. ~~이름이 **파일 전송 프로토콜**이니까~~

유명한 프로토콜이라 거의 대부분의 환경에서 이를 지원하므로, 나스라면 반드시 깔아야 할 서비스라고 볼 수 있습니다.

이 글을 통해 서버를 설정한 후,

- [**FileZilla**](https://filezilla-project.org/){: target="_blank"}를 통해 단순히 나스의 파일을 관리할 수도 있구요,
- [**RaiDrive**](https://www.raidrive.com/){: target="_blank"}를 설치해 집 밖에서도 아예 네트워크 드라이브처럼 쓴다거나,
- [**CX 파일 탐색기**](https://play.google.com/store/apps/details?id=com.cxinventor.file.explorer){: target="_blank"}와 같은 안드로이드 탐색기 앱에 연결시켜 쓸 수도 있고,
- [**FolderSync**](https://play.google.com/store/apps/details?id=dk.tacit.android.foldersync.lite){: target="_blank"}를 설치하여 스마트폰과 나스의 데이터를 동기화 시킬 수도 있습니다.

결론은, 대부분의 파일 관리 서비스는 FTP를 지원하므로, 그 활용 가치가 높습니다. 빨리 깔아봅시다.

---

# FTP 활성화하기

![FTP 서비스 활성화]({{"/assets/images/2019-10-27/2019-10-27-01-01.png"| relative_url}})

**서비스 > FTP** 페이지에서 서비스를 활성화합니다. 여러 일반 설정이 있는데,

- **포트**: FTP를 서비스할 포트를 지정합니다. 기본값은 **21**인데, 이 포트번호는 매우<sup>x100</sup> 유명한 번호 중 하나이므로, 적절한 보안 대책이 없다면 다른 번호로 바꿔줘도 좋습니다.
- **최대 클라이언트**: 나스에 동시 접속할 FTP 클라이언트의 최대 숫자입니다. 나스 성능과 나누어 준 사용자 아이디를 고려하여 적당히 설정합니다.
- **호스트당 최대 연결**: 1개 접속자에서 얼마나 많은 연결을 가져갈 수 있는지에 대한 설정입니다. "어차피 1개 아니야?" 싶지만, FTP를 통해 영화+자막을 스트리밍한다거나, 이전 연결이 비정상적 종료되어 서버가 아직 끊어진 줄 모른다든지 하는 이유로 더 많이 필요할 수도 있어요. 적당한 크기로 잡아둔 뒤, 나스 사용 패턴을 확인하여 FTP 연결이 거부되거나 끊긴다 싶을 때 이 값을 조금씩 올려주면 됩니다. 아니면 처음부터 넉넉하게 설정하거나요.
- **최대 로그인 시도 횟수**: 설명 그대로인데, 1로 둡니다. ~~딱히 변경해야 하는 이유를 모르겠어요...~~
- **익명 FTP 활성화**: 이 옵션을 켜면 **Anonymous** 로그인이 가능해지는데 (일반적으로 ID를 메일 주소로 넣는다고 해요.), 우리는 공개된 FTP서버는 아니니 활성화 할 필요는 없습니다.
- **환영 메시지**: FTP에 접속하게 되면 나오는 메시지! 인데... CLI 환경이 아닌 이상 이를 표시해 주는 클라이언트가 거의 없습니다.

아래 옵션도 읽어봅시다.

![FTP 고급 설정]({{"/assets/images/2019-10-27/2019-10-27-01-02.png"| relative_url}})

다른 옵션들은 크게 관심이 없고, (대역폭 제한이나 다시 시작, 전송 기록 정도가 쓸 만합니다.) 수동 FTP 설정을 알아볼 필요가 있는데요. 이 옵션을 켜지 않으면 나스가 알아서 포트를 설정하지만, 우리는 공유기 아래에 나스를 두고 서비스할 것이므로 이 범위를 지정해 줄 필요가 있습니다.

저는 활성화 시 기본으로 잡혀 있는 **49152:65534** 대역을 사용하기로 했습니다. 만약 해당 범위에 다른 서비스 포트가 포함된다면 다른 범위로 잡아주세요.

# 공유 폴더 추가

SMB 설정을 했다면 큰 설명이 필요 없는 과정입니다. 그림 두개로 끝낼게요.

![Content 공유 추가]({{"/assets/images/2019-10-27/2019-10-27-01-03.png"| relative_url}})

이렇게 Contents 폴더를 추가하고, 같은 방법으로 Public 폴더도 추가시키면

![공유 추가 완료]({{"/assets/images/2019-10-27/2019-10-27-01-04.png"| relative_url}})

위와 같은 화면이 나오며 완성!

# FileZilla로 확인하기

앞에서 얘기했듯 FTp를 사용하는 프로그램은 정말 많이 있는데, 일단 [**FileZilla**](https://filezilla-project.org/){: target="_blank"}를 사용해 봅시다.

![FileZilla 빠른 연결 설정]({{"/assets/images/2019-10-27/2019-10-27-01-05.png"| relative_url}})

이런 식으로 나스의 IP (또는 도메인), 사용자명과 비밀번호, 포트를 넣고 연결하면,

![FileZilla 리모트 사이트 화면]({{"/assets/images/2019-10-27/2019-10-27-01-06.png"| relative_url}})

이렇게 공유 폴더가 뜨는 것을 확인할 수 있습니다.

---

# 그리고 남은... 아니 이게 더 중요한 것 같은데?

물론 홈 네트워크 내부에서만 사용하려고 했으면 FTP를 설정할 필요까지는 없습니다. ~~그래서 SMB를 먼저 했죠?~~

이 단계에서는 공유기 외부에서도 나스의 FTP에 접속할 수 있도록 포트포워딩 설정을 할 건데요. ipTIME과 ASUS 공유기 2종류에 대해서 설정하는 법을 보여드리는데, 다른 공유기도 비슷한 과정으로 **포트포워딩** 메뉴에서 쉽게 설정할 수 있습니다.

## ipTIME 포트포워딩 설정

**NAT/라우터 관리 > 포트포워드 설정**에서 할 수 있어요.

![ipTIME FTP Ctrl 포트포워드 설정]({{"/assets/images/2019-10-27/2019-10-27-01-07.png"| relative_url}})

이건 FTP 제어 포트,

![ipTIME FTP Data 포트포워드 설정]({{"/assets/images/2019-10-27/2019-10-27-01-08.png"| relative_url}})

이건 FTP 데이터 통신 포트 설정입니다. OMV에서 설정을 바꾸어줬다면 여기에서도 동일하게 적어주어야 해요.

## ASUS 포트포워딩 설정

ASUS 공유기는 **WAN > 가상서버 / 포트 포워딩** 페이지에서 설정할 수 있어요.

![ASUS FTP Ctrl 포트포워드 설정]({{"/assets/images/2019-10-27/2019-10-27-01-09.png"| relative_url}})

마찬가지로 FTP 제어 포트,

![ASUS FTP Data 포트포워드 설정]({{"/assets/images/2019-10-27/2019-10-27-01-10.png"| relative_url}})

FTP 데이터 통신 포트 설정입니다. 내부 포트 번호를 적지 않으면 외부와 같은 포트번호로 자동 포워딩된다는 의미입니다.

이렇게 설정한 후, 공유기의 외부 IP/도메인과 외부 포트번호를 가지고 연결이 되는지 확인하면 됩니다.

---

# 그리고 진짜 남은 이야기

지금은 공유기 외부에서 접속할 때 인터넷 사업자가 제공해 준 공유기의 공인 IP를 사용하고 있는데, 일반적인 가정집의 경우 이 번호가 주기적으로 바뀝니다. 언제 바뀔지도 모르는 이 번호를 통해서 외부 접속을 할 수는 없으니, **DDNS**<sup>Dynamic Domain Name System</sup> 설정을 해야 해요. 그리고 앞으로 설명할 서비스들이 대부분 외부 접속을 염두에 두고 있구요.

그래서 다음 글은 공유기에서 DDNS 설정하는 방법이 되겠습니다.
