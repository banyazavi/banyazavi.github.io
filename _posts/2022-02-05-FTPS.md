---
title: "[OMV6 on HC4] FTPS"
excerpt: FTPS는 보안이 강화된 파일 전송 프로토콜입니다. 이제 집 밖에서도 안전하게 나스에 접속할 수 있어요.
categories:
  - OMV6 on HC4
sidebar:
  - nav: omv6_nas
tags:
  - FTP
  - FTPS
  - NAS
  - OMV6
  - openmediavault
---

**FTP**<sup>File Transfer Protocol</sup>는 네트워크에서 가장 유명한 파일 전송 방법입니다. 그리고 **FTPS**<sup>FTP Secure</sup>는 여기에 **SSL** 인증을 추가한 방식이죠. SSL 인증을 통해 전송 내용을 암호화할 수 있습니다.

**SFTP**<sup>Secure File Transfer Protocol</sup>와는 이름만 비슷하고 기원이 다른 프로토콜입니다. FTPS는 FTP에 보안이 추가된 형태이고, SFTP는 **SSH**<sup>Secure SHell</sup>에 FTP와 같은 파일 전송 기능이 추가된 형태에요. 그리고 여기서는 **FTPS**를 설정하도록 하겠습니다.

우선, SSL 인증서부터 하나 생성하도록 하죠.

---

# 자가 서명 SSL 인증서 생성

![시스템 > 인증 > SSL]({{"/assets/images/2022-02-05/2022-02-05-01-01.png"| relative_url}})

우선 OMV의 메뉴를 통해 SSL 인증서부터 생성해보도록 하겠습니다. **시스템 > 인증 > SSL** 메뉴에서 생성할 수 있어요.

지금은 아무것도 없는 상태이므로, **생성** 버튼을 눌러 인증서를 하나 만들어 보도록 합시다.

![시스템 > 인증 > SSL > 생성]({{"/assets/images/2022-02-05/2022-02-05-01-02.png"| relative_url}})

그림에 보이는 항목만 적어 주면 됩니다. 나머지는 선택 사항으로 적지 않아도 생성에는 문제가 없어요. **일반 이름** 역시 아무렇게나 지어도 상관은 없는데요, 보통은 서버의 도메인 주소나 IP를 넣게 됩니다. 저는 이 부분에 저번에 등록한 **DDNS** 도메인을 널었어요.

![시스템 > 인증 > SSL (생성 후)]({{"/assets/images/2022-02-05/2022-02-05-01-03.png"| relative_url}})

이렇게 생성하면 SSL 인증서 준비는 완료되었습니다.

# FTP 서비스 활성화, SSL 설정

![서비스 > FTP > 설정]({{"/assets/images/2022-02-05/2022-02-05-01-04.png"| relative_url}})

**서비스 > FTP > 설정** 메뉴에서 FTP를 활성화합니다. 대부분 기본값을 사용해도 큰 문제가 없어요. 저는 아래 설정만 변경했어요.

- 유효한 쉘이 필요합니다: 이 설정은 접속하는 사용자 계정의 **셸** 설정에 `bash`와 같은 셸이 지정되어 있어야 한다는 뜻이에요. 저는 FTP는 이 옵션을 해제하여 모든 사용자가 접속할 수 있게 하고, 대신에 관리자를 제외한 모든 사용자 계정의 셸을 `nologin`으로 변경하여 **SSH**로는 접속하지 못하게 하는 방식을 쓰고 있어서 이 부분을 선택 해제했어요.
- 수동 FTP (49152 - 65534): 데이터 전송에 필요한 포트 범위를 지정합니다. 지금 지정한 범위는 OMV FTP의 기본값인데요, 실제 사용자가 많지 않을 때는 범위가 이렇게 넓을 필요는 없어요. 이 값은 나중에 공유기의 **포트포워드 설정**에 등록해야 하니 꼭 기억해야 해요!

![서비스 > FTP > SSL/TLS Settings]({{"/assets/images/2022-02-05/2022-02-05-01-05.png"| relative_url}})

이제 **서비스 > FTP > SSL/TLS Settings** 메뉴에서 FTPS 설정을 할 수 있어요. **Certificate** 항목에서 아까 등록한 SSL 인증서를 선택하고, 그림과 같이 **필수**, **세션 재사용 불필요** 항목을 활성화하면 됩니다.

![서비스 > FTP > 공유]({{"/assets/images/2022-02-05/2022-02-05-01-06.png"| relative_url}})

이제 FTP에서 사용할 공유 폴더를 등록해야겠죠. **서비스 > FTP > 공유** 메뉴로 들어갑니다.

![서비스 > FTP > 공유 > 생성 (data)]({{"/assets/images/2022-02-05/2022-02-05-01-07.png"| relative_url}})

공유 폴더 등록은 별것이 없습니다. **Shared folder**에서 FTP에 사용할 공유 폴더를 선택하고 저장하면 끝이에요.

![서비스 > FTP > 공유 > 생성 (archive)]({{"/assets/images/2022-02-05/2022-02-05-01-08.png"| relative_url}})

`archive` 폴더도 똑같이 등록하면 되겠죠. 다른 공유 폴더도 FTP로 서비스하려면 같은 작업을 하면 됩니다.

![서비스 > FTP > 공유 (설정 후)]({{"/assets/images/2022-02-05/2022-02-05-01-09.png"| relative_url}})

그러면 이렇게 FTP 공유 폴더 등록이 완료됩니다.

# 공유기 포트포워드 설정

![ipTIME 포트포워드 설정]({{"/assets/images/2022-02-05/2022-02-05-01-10.png"| relative_url}})

FTP 설정은 완료되었는데요, 외부에서 접속하려면 공유기에 **포트포워드 설정**을 해야 합니다! 공유기마다 방법이 달라 자세하게 설명하긴 힘들지만, **서비스 > FTP > 설정**에서 설정한 것과 같이 TCP 프로토콜의 21번 포트 (Port) 와 49152~65534 (Min.-Max. passive port 범위) 가 공유기의 내부 IP로 포워딩 지정되면 됩니다. ipTIME이라면 그림의 설정과 **내부 IP**를 제외하고는 똑같이 설정하면 돼요.

그럼 외부접속까지 할 수 있는 모든 준비가 끝났습니다. 이제 스마트폰에서 한번 접속해 보도록 하죠.

## 접속 설정 및 확인

![CX 파일 탐색기 아이콘]({{"/assets/images/2022-02-05/2022-02-05-01-11.png"| relative_url}})  
[CX 파일 탐색기 (Google Play)](https://play.google.com/store/apps/details?id=com.cxinventor.file.explorer){: target="_blank"}

스마트폰에서 접속하기 위해 **CX 파일 탐색기**라는 앱을 사용할 거예요. 아이폰은 파일 관리자 앱은 사용할 수 없고, 동영상 스트리밍용으로 [**nPlayer**](https://apps.apple.com/kr/app/nplayer/id1116905928){: target="_blank"}에서 FTPS 서버를 추가할 수 있어요.

![CX 파일 탐색기]({{"/assets/images/2022-02-05/2022-02-05-01-12.png"| relative_url}})

CX 파일 탐색기를 실행하고 **네트워크** 탭의 **새 저장소** 버튼을 누릅니다.

![CX 파일 탐색기 > 원격 저장소]({{"/assets/images/2022-02-05/2022-02-05-01-13.png"| relative_url}})

**원격 저장소** 탭에 **FTP**가 있죠. FTPS 또한 이 항목에서 설정할 수 있습니다. 앞서 이야기한 것처럼, **SFTP**는 전혀 다른 방식이에요!

![CX 파일 탐색기 > 원격 저장소 > FTP]({{"/assets/images/2022-02-05/2022-02-05-01-14.png"| relative_url}})

**호스트**에 공유기의 외부 IP나 [DuckDNS에서 등록한](/2022-01-23/DuckDNS-DDNS) 도메인을 적고, 포트 번호를 넣은 다음에 프로토콜을 **FTPS**로 선택합니다. 그리고 접속할 사용자 이름과 비밀번호를 입력하고 **확인**을 누르면 끝이에요. 그리고 연결이 정상적으로 되면,

![CX 파일 탐색기 > FTP 접속]({{"/assets/images/2022-02-05/2022-02-05-01-15.png"| relative_url}})

짠! 이렇게 스마트폰에서 FTPS에 접속할 수 있게 됩니다.

---

# 그리고 남은 이야기

FTPS 설정을 끝으로 OMV를 통한 기본적인 서비스 설정은 완료되었어요. 이후의 서비스는 모두 도커를 사용해서 설치하게 되는데요, [이전 도커 시리즈](/category/docker_nas/)와 사실상 같은 내용이 될 것 같아 고민이네요.
